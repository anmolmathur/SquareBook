<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.4.5" />
<title>PHPPgSQL</title>
<style type="text/css">
/* Debug borders */
p, li, dt, dd, div, pre, h1, h2, h3, h4, h5, h6 {
/*
  border: 1px solid red;
*/
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

tt {
  color: navy;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  font-family: sans-serif;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}

div.sectionbody {
  font-family: serif;
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}

pre {
  padding: 0;
  margin: 0;
}

span#author {
  color: #527bbd;
  font-family: sans-serif;
  font-weight: bold;
  font-size: 1.1em;
}
span#email {
}
span#revnumber, span#revdate, span#revremark {
  font-family: sans-serif;
}

div#footer {
  font-family: sans-serif;
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
div#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
div#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

div#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.tableblock, div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.5em;
  margin-bottom: 2.5em;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-family: sans-serif;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid silver;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid silver;
  background: #f4f4f4;
  padding: 0.5em;
}

div.quoteblock {
  padding-left: 2.0em;
  margin-right: 10%;
}
div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock {
  padding-left: 2.0em;
  margin-right: 10%;
}
div.verseblock > div.content {
  white-space: pre;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 2px solid silver;
}

div.exampleblock > div.content {
  border-left: 2px solid silver;
  padding: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

div.tableblock > table {
  border: 3px solid #527bbd;
}
thead {
  font-family: sans-serif;
  font-weight: bold;
}
tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

@media print {
  div#footer-badges { display: none; }
}

div#toctitle {
  color: #527bbd;
  font-family: sans-serif;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}
/* Workarounds for IE6's broken and incomplete CSS2. */

div.sidebar-content {
  background: #ffffee;
  border: 1px solid silver;
  padding: 0.5em;
}
div.sidebar-title, div.image-title {
  color: #527bbd;
  font-family: sans-serif;
  font-weight: bold;
  margin-top: 0.0em;
  margin-bottom: 0.5em;
}

div.listingblock div.content {
  border: 1px solid silver;
  background: #f4f4f4;
  padding: 0.5em;
}

div.quoteblock-attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock-content {
  white-space: pre;
}
div.verseblock-attribution {
  padding-top: 0.75em;
  text-align: left;
}

div.exampleblock-content {
  border-left: 2px solid silver;
  padding-left: 0.5em;
}

/* IE6 sets dynamically generated links as visited. */
div#toc a:visited { color: blue; }
</style>
</head>
<body>
<div id="header">
<h1>PHPPgSQL</h1>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p>PHPPgSQL is a PHP database access class for PostgreSQL with state of the art
performance enhancements and user interface. It is designed to be as easy to
use as possible and hide all the complexities away.</p></div>
</div>
</div>
<h2 id="_features">Features</h2>
<div class="sectionbody">
<div class="paragraph"><p>PHPPgSQL has the following features important for modern web applications:</p></div>
<div class="ulist"><ul>
<li>
<p>
Provides an easy to use and intuitively understandable Iterator API for
   retrieving database data.
</p>
</li>
<li>
<p>
Uses prepared statements on the PostgreSQL database backend side, providing
   performance boosts for both repeatable queries with changing arguments and
   in case "persistent" connections are used with PHP, all other queries.
</p>
</li>
<li>
<p>
Uses <tt>memcached</tt> as a query cache to store and retrieve frequently queried
   data, reducing database load.
</p>
</li>
</ul></div>
</div>
<h2 id="_dependencies">Dependencies</h2>
<div class="sectionbody">
<div class="paragraph"><p>PHPPgSQL depends on the following PHP modules / extensions:</p></div>
<div class="ulist"><ul>
<li>
<p>
pgsql
</p>
</li>
<li>
<p>
pcre
</p>
</li>
<li>
<p>
memcache
</p>
</li>
</ul></div>
</div>
<h2 id="_class_documentation"> Class documentation</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre><tt>SQL query class; implements Iterator for row fetching and tries too hard to perform
smart cacheing. The first argument is the parametrized SQL query with $1,$2,... as
parameter plceholders. The other arguments are the required parameters.

The function will fail when the number of arguments reaches about 20.

Usage:
        $q = new PHPPgSQL([flags,] SQL [, arg0, arg1...])

Optional flag is one of:
        * PHPPgSQL::NO_CACHE            - Don't retrieve the results of this query from the cache
        * PHPPgSQL::PREPARE_ONLY        - Don't execute the SQL query in the constructore - use execute() method instead

The only accessible field is reccount - containing the number of records returned or affected by the query.
For SELECT queries, PHPPgSQL implements the Iterator interface for iterating over returned rows</tt></pre>
</div></div>
<div class="paragraph"><p>All methods of PHPPgSQL objects will throw exceptions based on the
<tt>PHPPGSQLException</tt> exception class.</p></div>
</div>
<h2 id="_configuration">Configuration</h2>
<div class="sectionbody">
<div class="paragraph"><p>The library include file, phppgsql.php, expects the following variables to be
set before it is included:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #009900">$PHPPGSQL_DB_CONNECTION</span> <span style="color: #990000">=</span> <span style="color: #FF0000">'dbname=idx user=idx'</span><span style="color: #990000">;</span>
<span style="color: #009900">$PHPPGSQL_DB_CACHE_TIMEOUT</span> <span style="color: #990000">=</span> <span style="color: #993399">10</span><span style="color: #990000">;</span>
<span style="color: #009900">$PHPPGSQL_MEMCACHED_SERVER</span> <span style="color: #990000">=</span> <span style="color: #FF0000">'localhost'</span><span style="color: #990000">;</span></tt></pre></div></div>
<div class="paragraph"><p>Additionally, the following variables can override the built-in defaults:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #009900">$PHPPGSQL_MEMCACHED_PORT</span> <span style="color: #990000">=</span> <span style="color: #993399">11211</span><span style="color: #990000">;</span>
<span style="color: #009900">$PHPPGSQL_ENCODING</span> <span style="color: #990000">=</span> <span style="color: #FF0000">'UTF-8'</span><span style="color: #990000">;</span></tt></pre></div></div>
</div>
<h2 id="_examples">Examples</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #009900">$q</span> <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">PHPPgSQL</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"SELECT comment FROM forum WHERE forum_id=$1 AND user_id=$2"</span><span style="color: #990000">,</span> <span style="color: #009900">$forum_id</span><span style="color: #990000">,</span> <span style="color: #009900">$uid</span><span style="color: #990000">);</span>
<span style="font-weight: bold"><span style="color: #0000FF">foreach</span></span> <span style="color: #990000">(</span><span style="color: #009900">$q</span> <span style="font-weight: bold"><span style="color: #0000FF">as</span></span> <span style="color: #009900">$row</span><span style="color: #990000">)</span>
        <span style="font-weight: bold"><span style="color: #000000">var_dump</span></span><span style="color: #990000">(</span><span style="color: #009900">$row</span><span style="color: #990000">);</span>
<span style="font-weight: bold"><span style="color: #0000FF">echo</span></span> <span style="color: #FF0000">"There are {$q-&gt;reccount} records.\n"</span><span style="color: #990000">;</span></tt></pre></div></div>
<div class="paragraph"><p>Executes a SELECT query and dumps the result records.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">foreach</span></span> <span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">PHPPgSQL</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"SELECT * FROM table"</span><span style="color: #990000">)</span> <span style="font-weight: bold"><span style="color: #0000FF">as</span></span> <span style="color: #009900">$row</span><span style="color: #990000">)</span>
        <span style="font-weight: bold"><span style="color: #000000">var_dump</span></span><span style="color: #990000">(</span><span style="color: #009900">$row</span><span style="color: #990000">);</span></tt></pre></div></div>
<div class="paragraph"><p>Iterates over a query result without a temporary variable.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">PHPPgSQL</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"BEGIN"</span><span style="color: #990000">);</span>
<span style="color: #009900">$q</span> <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">PHPPgSQL</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"INSERT INTO table (id, name) VALUES ($1, $2)"</span><span style="color: #990000">);</span>
<span style="font-weight: bold"><span style="color: #0000FF">for</span></span> <span style="color: #990000">(</span><span style="color: #009900">$i</span> <span style="color: #990000">=</span> <span style="color: #993399">0</span><span style="color: #990000">;</span> <span style="color: #009900">$i</span> <span style="color: #990000">&lt;</span> <span style="color: #993399">10</span><span style="color: #990000">;</span> <span style="color: #009900">$i</span><span style="color: #990000">++)</span>
        <span style="color: #009900">$q</span><span style="color: #990000">-&gt;</span><span style="font-weight: bold"><span style="color: #000000">execute</span></span><span style="color: #990000">(</span><span style="color: #009900">$i</span><span style="color: #990000">,</span> <span style="color: #FF0000">"name$i"</span><span style="color: #990000">);</span>
<span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">PHPPgSQL</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"COMMIT"</span><span style="color: #990000">);</span></tt></pre></div></div>
<div class="paragraph"><p>Inserts 10 records into the database, within a transaction.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 2.11.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #009900">$q</span> <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">PHPPgSQL</span></span><span style="color: #990000">(</span>PHPPgSQL<span style="color: #990000">::</span>PREPARE_ONLY<span style="color: #990000">,</span> <span style="color: #FF0000">"SELECT a,b,c FROM t1 JOIN t2 ON t1.x=t2.y JOIN t3 ON t1.w=t3.z JOIN t4 ON t3.u=t2.p WHERE y=$1"</span><span style="color: #990000">);</span>
<span style="font-weight: bold"><span style="color: #0000FF">for</span></span> <span style="color: #990000">(</span><span style="color: #009900">$i</span> <span style="color: #990000">=</span> <span style="color: #993399">0</span><span style="color: #990000">;</span> <span style="color: #009900">$i</span> <span style="color: #990000">&lt;</span> <span style="color: #993399">10</span><span style="color: #990000">;</span> <span style="color: #009900">$i</span><span style="color: #990000">++)</span>
        <span style="color: #009900">$q</span><span style="color: #990000">-&gt;</span><span style="font-weight: bold"><span style="color: #000000">execute</span></span><span style="color: #990000">(</span><span style="color: #009900">$i</span><span style="color: #990000">);</span></tt></pre></div></div>
<div class="paragraph"><p>Perform 10 SELECTs with complex JOINs by taking advantage of parametrized
queries. The database query plans will be cached on object creation and
subsequent query invocations will be executed with the cached plan. Plan
caching can significantly improve performance of complex queries.</p></div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2009-07-30 04:24:45 CEST
</div>
</div>
</body>
</html>
